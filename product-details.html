<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√úr√ºn Detayƒ± | Onur ƒ∞n≈üaat</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header buraya y√ºklenecek -->
    <div id="header"></div>

    <nav>
        <ul>
            <li><a href="index.html">Ana Sayfa</a></li>
            <li><a href="kategoriler.html">Kategoriler</a></li>
            <li><a href="urunler.html">√úr√ºnler</a></li>
            <li><a href="iletisim.html">ƒ∞leti≈üim</a></li>
            <li><a href="sepet.html">Sepetim (<span id="cart-count">0</span>)</a></li>
            <li><a href="favoriler.html">Favorilerim</a></li>
            <li class="theme-switch-wrapper">
                <label class="theme-switch" for="theme-toggle">
                    <input type="checkbox" id="theme-toggle" class="theme-checkbox">
                    <div class="theme-slider">
                        <div class="slider-circle">
                            <span class="theme-slider-icon sun">‚òÄÔ∏è</span>
                            <span class="theme-slider-icon moon">üåô</span>
                        </div>
                    </div>
                </label>
            </li>
        </ul>
    </nav>

    <main class="product-detail-page">
        <div class="container">
            <div class="breadcrumbs">
                <a href="index.html">Ana Sayfa</a> &gt; 
                <a href="urunler.html">√úr√ºnler</a> &gt; 
                <span id="product-breadcrumb">√úr√ºn Adƒ±</span>
            </div>
            
            <div class="product-details-container" id="product-details">
                <!-- JavaScript ile √ºr√ºn detaylarƒ± buraya y√ºklenecek -->
                <div class="loading">Y√ºkleniyor...</div>
            </div>
            
            <div class="related-products">
                <h2>Benzer √úr√ºnler</h2>
                <div class="products-grid" id="related-products">
                    <!-- JavaScript ile benzer √ºr√ºnler buraya y√ºklenecek -->
                </div>
            </div>
        </div>
    </main>

    <!-- Footer buraya y√ºklenecek -->
    <div id="footer"></div>
    
    <script src="scripts.js"></script>
    <script src="cart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // URL'den √ºr√ºn ID'sini al
            const urlParams = new URLSearchParams(window.location.search);
            const productId = parseInt(urlParams.get('id'));
            
            if (!productId) {
                window.location.href = 'urunler.html'; // ID yoksa √ºr√ºnler sayfasƒ±na y√∂nlendir
                return;
            }
            
            // √úr√ºn detaylarƒ±nƒ± y√ºkle
            loadProductDetails(productId);
            
            // Benzer √ºr√ºnleri y√ºkle
            loadRelatedProducts(productId);
            
            // Sepet sayacƒ±nƒ± g√ºncelle
            updateCartCount();
        });
        
        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            const cartCountElement = document.getElementById('cart-count');
            if (cartCountElement) {
                cartCountElement.textContent = totalItems;
            }
        }
        
        function loadProductDetails(productId) {
    const products = JSON.parse(localStorage.getItem('products')) || [];
    const product = products.find(p => p.id === productId);
    
    if (!product) {
        window.location.href = 'urunler.html'; // √úr√ºn bulunamazsa y√∂nlendir
        return;
    }
    
    // Sayfa ba≈ülƒ±ƒüƒ±nƒ± g√ºncelle
    document.title = `${product.name} | Onur ƒ∞n≈üaat`;
    document.getElementById('product-breadcrumb').textContent = product.name;
    
    // √úr√ºn detaylarƒ±nƒ± doldur
    const detailsContainer = document.getElementById('product-details');
    detailsContainer.innerHTML = `
        <div class="product-details-image">
            <img src="${product.image}" alt="${product.name}">
        </div>
        <div class="product-details-info">
            <h1>${product.name}</h1>
            <p class="category">Kategori: ${product.categoryName}</p>
            <div class="price-container">
                <p class="price">${product.price.toFixed(2)} ‚Ç∫</p>
            </div>
            <div class="description">
                ${product.description || 'Bu √ºr√ºn i√ßin a√ßƒ±klama bulunmamaktadƒ±r.'}
            </div>
            <div class="product-actions detail-actions">
                <div class="quantity">
                    <button class="qty-btn minus">-</button>
                    <input type="number" value="1" min="1" class="qty-input" id="product-quantity">
                    <button class="qty-btn plus">+</button>
                </div>
                <button class="btn add-to-cart-btn" data-id="${product.id}">Sepete Ekle</button>
            </div>
        </div>
    `;
    
    // Adet artƒ±rma-azaltma butonlarƒ±
    setupQuantityButtons();
    
    // Sepete ekle butonuna dinleyici ekle
    const addToCartBtn = document.querySelector('.add-to-cart-btn');
    if (addToCartBtn) {
        addToCartBtn.addEventListener('click', function() {
            const quantity = parseInt(document.getElementById('product-quantity').value);
            addToCart(productId, quantity);
        });
    }
}
        
        function loadRelatedProducts(productId) {
    const products = JSON.parse(localStorage.getItem('products')) || [];
    const currentProduct = products.find(p => p.id === productId);
    
    if (!currentProduct) return;
    
    // Aynƒ± kategorideki diƒüer √ºr√ºnleri bul (en fazla 4 tane)
    const relatedProducts = products
        .filter(p => p.category === currentProduct.category && p.id !== productId)
        .slice(0, 4);
    
    const relatedContainer = document.getElementById('related-products');
    
    if (relatedProducts.length === 0) {
        relatedContainer.innerHTML = '<p>Bu kategoride ba≈üka √ºr√ºn bulunamadƒ±.</p>';
        return;
    }
    
    relatedContainer.innerHTML = relatedProducts.map(product => `
        <div class="product-card">
            <div class="product-image">
                <img src="${product.image}" alt="${product.name}">
            </div>
            <div class="product-info">
                <h3>${product.name}</h3>
                <p class="product-price">${product.price.toFixed(2)} ‚Ç∫</p>
                <div class="product-actions">
                    <a href="product-details.html?id=${product.id}" class="btn details-btn">ƒ∞ncele</a>
                    <button class="btn add-to-cart-btn" data-id="${product.id}">Sepete Ekle</button>
                </div>
            </div>
        </div>
    `).join('');
    
    // Sepete ekle butonlarƒ±na dinleyici ekle
    const addToCartBtns = document.querySelectorAll('.add-to-cart-btn');
    addToCartBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const id = parseInt(this.dataset.id);
            addToCart(id);
        });
    });
}
        
        function setupQuantityButtons() {
            const minusBtn = document.querySelector('.qty-btn.minus');
            const plusBtn = document.querySelector('.qty-btn.plus');
            const qtyInput = document.querySelector('.qty-input');
            
            if (!minusBtn || !plusBtn || !qtyInput) return;
            
            minusBtn.addEventListener('click', function() {
                const value = parseInt(qtyInput.value);
                if (value > 1) {
                    qtyInput.value = value - 1;
                }
            });
            
            plusBtn.addEventListener('click', function() {
                const value = parseInt(qtyInput.value);
                qtyInput.value = value + 1;
            });
        }
    </script>
</body>
</html>
